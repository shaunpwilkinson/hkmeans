% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hkmeans.R
\name{hkmeans}
\alias{hkmeans}
\title{Hierarchcal divisive k-means clustering}
\usage{
hkmeans(x, ...)
}
\arguments{
\item{x}{a matrix}

\item{...}{further arguments to be passed to \code{kmeans} (not including
\code{centers}).}
}
\value{
Returns an object of class \code{"dendrogram"}.
}
\description{
This function recursively splits an n x p matrix into smaller and smaller subsets,
returning a "dendrogram" object.
}
\details{
This function creates a tree by successively splitting
  the dataset into smaller and smaller subsets (recursive
  partitioning). This is a divisive, or "top-down" approach to tree-building,
  as opposed to agglomerative "bottom-up" methods such as neighbor joining
  and UPGMA. It is particularly useful for large large datasets with many records
  (\emph{n} > 10,000) since the need to compute a large \emph{n} * \emph{n}
  distance matrix is circumvented.

  If a more accurate tree is required, users can increase the value
  of \code{nstart} passed to \code{kmeans} \emph{via} the \code{...} argument.
  While this can increase computation time, it can improve accuracy
  considerably.
}
\examples{
\dontrun{
## Cluster a subsample of the iris dataset
suppressWarnings(RNGversion("3.5.0"))
set.seed(999)
iris50 <- iris[sample(x = 1:150, size = 50, replace = FALSE),]
x <- as.matrix(iris50[, 1:4])
rownames(x) <- iris50[, 5]
dnd <- hkmeans(x, nstart = 20)
plot(dnd, horiz = TRUE, yaxt = "n")

## Color labels according to species
rectify_labels <- function(node, x){
  newlab <- factor(rownames(x))[unlist(node, use.names = FALSE)]
  attr(node, "label") <- newlab
  return(node)
}
dnd <- dendrapply(dnd, rectify_labels, x = x)

## Create a color palette as a data.frame with one row for each species
uniqspp <- as.character(unique(iris$Species))
colormap <- data.frame(Species = uniqspp, color = rainbow(n = length(uniqspp)))
colormap[, 2] <- c("red", "blue", "green")
colormap

## Color the inner dendrogram edges
color_dendro <- function(node, colormap){
  if(is.leaf(node)){
    nodecol <- colormap$color[match(attr(node, "label"), colormap$Species)]
    attr(node, "nodePar") <- list(pch = NA, lab.col = nodecol)
    attr(node, "edgePar") <- list(col = nodecol)
  }else{
    spp <- attr(node, "label")
    dominantspp <- levels(spp)[which.max(tabulate(spp))]
    edgecol <- colormap$color[match(dominantspp, colormap$Species)]
    attr(node, "edgePar") <- list(col = edgecol)
  }
  return(node)
}
dnd <- dendrapply(dnd, color_dendro, colormap = colormap)

## Plot the dendrogram
plot(dnd, horiz = TRUE, yaxt = "n")
}
}
\references{
TBA
}
\author{
Shaun Wilkinson
}
